---
layout: post
title: Week 5 - Hummingbird Agent Results and The Future
---

The fifth week of research involved finishing up the ML-Agents Hummingbirds training. 

## ML-Agents Hummingbird: Training Results

The ML-Agent has made significant progress by the end of its training session which took a total of about 6 hours to complete. However, I was training using CPU only, so the required time could be significantly shorter. But before I show you the end results, I feel it fitting to remind you of how the Hummingbird was performing early on in its training.

### Where We Began

First hour and a half of training:
![Hummingbird Vibin'](/resources/hummingbird-vibin.gif "Hummingbird Vibin'")
The Hummingbird just aimlessly hovers pondering its existence.

After about two hours of training:
![Hummingbird Drinking Nectar](/resources/hummingbird-drinking-nectar.gif "Hummingbird Drinking Nectar")
The Hummingbird has discovered nectar and realized it is the drink of the gods. Although it is still not very good at getting to it, yet.

A quick graph of the first two hours of training:
![Hummingbird Training 2hr Graph](/resources/training-2hr-graph.PNG "Hummingbird Training 2hr Graph")
Look at that rapid growth! I knew he had it in him!

### How Far We've Come

Now it's about time I show you the fully trained agent. Here is an uninterrupted full minute of its nectar collecting spree:
<iframe width="560" height="315" src="https://www.youtube.com/embed/TJhCQ9WWLTM" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"> </iframe>
Look at him go! They grow up so fast. 

In all seriousness, the Hummingbird agent has significantly improved by the end of the training session, after 5 million steps, than where it was 2 hours in, at approx. 1.5 million steps. Although it isn't perfect, it generally has no issue getting its beak into the flower and staying long enough to collect the nectar before moving on the next flower. 

Now let's check out the graph of its progress throughout the training session.
![Hummingbird Completed Training Graph](/resources/training-completed-graph.PNG "Hummingbird Completed Training Graph")
From this we can see the Hummingbird agent started off very slow, not making any significant progress for the first approx. 1 million to 1.2 million steps (~1 hour). I assume this slow progress can be accounted for by the Hummingbird not accidently stumbling into some nectar. However, once the agent discovered nectar, it made progress significantly faster. The agent went from getting an average of 0 flowers at 1 million steps to an average of 34.26 flowers at 2 million steps. After about 2.5 million to 3 million steps, the agent's progress started to level off. At this point the agent averaged anywhere from just under 25 flowers on the low end to just over 50 flowers on the high end. Generally, it got about 38 flowers worth of nectar a run. Although this range may seem large, the disparity in average nectar collected can be attributed to the random spawn position of the Hummingbird agent at the start of any given run. 

All in all, I think it turned out to be a success. The Hummingbird agent was able to learn to collect a considerable amount nectar from flowers within only 5 million steps. This may seem like a lot, but consider the fact that any living thing with a brain is a product of millions of years of evolution, while the Hummingbird agent learned a fairly complex task in merely 6 hours. For some added perspective, fruit flies have about 25 thousand nuerons, while the hummingbird agent only has 512 nuerons. But then again, the hummingbird agent doesn't have to account for living.

## ML-Agents Hummingbird: The Game

After completing the training, I learned that you can connect the trained nueral network to the game object under Behavior Parameters. Then you can run the agent outside of training mode and watch it show off what it learned. As a fun experiment, I turned the project into a game where you compete with the ML agent to see who can collect a certain amount of nectar faster. 

During this process, I noticed some bugs in my earlier code that only seemed to occur outside of training mode. After spending an hour or so fixing them, I proceeded to setting up a new scene with a player and opponent hummingbird agents. I created a basic game manager class and imported the tutorial provided UI elements. Once I was finished setting everything up, I had a working game where a player could compete against the Hummingbird agent to see who was the better at collecting nectar.

Here is my best attempt at trying to beat the Hummingbird Agent:
<iframe width="560" height="315" src="https://www.youtube.com/embed/ByaFSv-F5Qg" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"> </iframe>
The Hummingbird agent was easily able to get 8 flowers worth of nectar in the time it took me to get only about half of that. Assuming the game went on longer, the agent probably would have only widened the gap. That should make it apparent that the ML agent fully learned the task it was created to.

In case anyone wants to try their hand at beating the Hummingbird agent, I will leave a Unity build with the game controls below. Fair warning, the controls are pretty janky (it wasn't intended to be a good game).

## ML-Agents Penguins

After completing the ML-Agents Hummingbirds tutorial I thought I would be able to go back and modify the old ML-Agents Penguins project to work. However, after about an hour to an hour and a half of tinkering with it. I realized that I would need to make far too many changes to even have a runnable version. At that point, I decided it wasn't really worth the extra effort and should just be left as a relic of the past. 

## ML-Agents Hummingbird: WebGL Build

Controls:
 - Forward/Left/Backward/Right: W/A/S/D
 - Up/Down: E/Q
 - Pitch Up/Pitch Down: Up Arrow/Down Arrow/Down
 - Turn Left/Right: Left Arrow/Right Arrow

<iframe src="/resources/WebBuild/index.html" style="border:0px #000000 none;" name="Game name" scrolling="no" frameborder="1" marginheight="px" marginwidth="320px" height="320px" width="480px"> </iframe>

## Next Week's Plan

Next week, I plan on returning with the results of many more hours of training and the completed environment where the player can compete against the ML-Agent. I also plan on going back and fixing up the ML-Agent Penguins just so I can experiment with it a bit more. Finally, I plan on diving into the UnityVGDL Framework.

Thanks for reading! Make sure to check back next week!
